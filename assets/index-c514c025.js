import{r as c,j as a,c as R,a as B}from"./index-8b435b75.js";import{b as D}from"./index-fdd3a7d6.js";import{u as K}from"./use-merged-prop-ref-bd8415d7.js";import{I as g}from"./index-f0ac2a00.js";import{P as U}from"./popup-helper-5cd0647a.js";import{c as $}from"./config-component-props-c0788442.js";import{P as Y}from"./index-8d4b6373.js";import{c as W}from"./detect-9e279ab2.js";import{n as q}from"./misc-276e45ca.js";const y="fnx-toast",b=B(y),z=$({visible:!1,duration:2e3,forbidClick:!1,overlay:!1,overlayCloseable:!1,onClick:q}),S="".concat(y,"--unclickable");let u=0;const L=c.forwardRef((e,o)=>{const[{visible:t,duration:s,forbidClick:i,overlay:f,overlayCloseable:m,onClick:p},{mountTo:h,position:d,message:C,icon:v,clickCloseable:M,children:O,className:A,..._}]=z(e),[x,T]=c.useState(!1);c.useEffect(()=>{if(T(t),t&&s>0){const r=setTimeout(()=>{T(!1)},s);return()=>{clearTimeout(r)}}},[t,s]),c.useEffect(()=>{if(x&&i&&W())return u||document.body.classList.add(S),u++,()=>{u--,u||document.body.classList.remove(S)}},[x,i]);const I=()=>{const r=v;return r&&a.jsx("div",{className:b("icon"),children:r})},H=()=>{const r=C||O;return r&&a.jsx("div",{className:b("message"),children:r})};return a.jsxs(Y,{visible:x,mountTo:h,className:R(b([d,{text:!v}]),A),renderOnShow:!0,destroyOnHide:!0,lockScroll:!1,overlay:f,overlayCloseable:m,..._,ref:o,onClick:r=>{M&&T(!1),p(r)},children:[I(),H()]})});L.displayName="Toast";const P=L,j=new U;let k=!1;function F(e,o={}){return j.create(({onUpdate:t,remove:s})=>{const i=()=>{const[{onAfterHide:f,...m},p]=c.useState(e);return c.useEffect(()=>t(d=>{p(C=>({...C,...d}))}),[]),a.jsx(P,{visible:!0,...m,mountTo:!1,onAfterHide:()=>{s(),f&&f()}})};return i.displayName="ToastStatic",i},o.container)}const n=P,l=(e,o={},t)=>{const s=typeof e=="string"?{message:e}:e;return k||n.clearAll(),F({...o,...s},t)},w=(e,o)=>l(e,{icon:a.jsx(g.Spinner,{}),forbidClick:!0},o),N=(e,o)=>l(e,{icon:a.jsx(g,{name:"success"})},o),E=(e,o)=>l(e,{icon:a.jsx(g,{name:"fail"})},o);n.show=e=>l(e);n.loading=e=>w(e);n.success=e=>N(e);n.fail=e=>E(e);n.useToast=()=>{const e=c.useContext(D),o=K(e);return c.useMemo(()=>{const t=()=>({container:o.current.mountTo()});return{show:s=>l(s,{},t()),loading:s=>w(s,t()),success:s=>N(s,t()),fail:s=>E(s,t())}},[o])};n.clearAll=()=>{j.clear()};n.allowMultiple=e=>{k=!!e};const te=n;export{te as T};
