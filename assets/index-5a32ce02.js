import{r as e,a as ee,j as s,c as H}from"./index-8b435b75.js";import{C as te}from"./index-fdd3a7d6.js";import{c as U}from"./config-component-props-c0788442.js";import{u as se}from"./use-controlled-state-e2423fe7.js";import{u as V}from"./use-creation-3d9fab3f.js";import{u as ne}from"./use-merged-prop-78f8d6c6.js";import{S as ae}from"./index-8a37499c.js";import{u as re,S as q}from"./index-6ad4a01f.js";import{a as O,c as oe}from"./format-3509efe4.js";import{i as ie}from"./misc-276e45ca.js";import{t as ce}from"./react-a0edb2dd.js";import{u as z}from"./use-merged-prop-ref-bd8415d7.js";import{u as le}from"./use-get-state-34a6027d.js";import{u as ue}from"./use-update-effect-311108d7.js";import{c as de}from"./constants-a731eda5.js";import{r as fe,c as me,d as pe}from"./raf-e95fb200.js";const _=e.createContext({}),G=e.createContext({});function he(o){const d=[],i=[];return ce(o).forEach((t,n)=>{if(!e.isValidElement(t))return;const a=t.key!=null?"".concat(t.key):"".concat(n);i.push(a),d.push({key:a,title:t.props.title,disabled:!!t.props.disabled,panel:e.cloneElement(t,{key:a,...t.props,"data-fnx-tab-panel-key":a})})}),[V(t=>t&&ie(t,i)?t:i,[i]),d]}const be="fnx-tabs",u=ee(be),ve=(o,d,i)=>{let c=0;const t=o.scrollLeft,n=i===0?1:Math.round(i/16);let a;function p(){o.scrollLeft+=(d-t)/n,++c<n?a=fe(p):a=void 0}return p(),()=>{a!=null&&me(a)}},F=e.forwardRef(({activeIndex:o,scrollable:d,ellipsis:i,transitionDuration:c,trackColor:t,slots:n,border:a,metaList:p,onChange:g,...h},f)=>{const k=z(c),y=z(o),x=e.useRef(null),j=e.useRef({}),T=e.useRef(),A=re(),W=e.useMemo(()=>O(h.trackWidth),[h.trackWidth]),$=e.useMemo(()=>O(h.trackHeight),[h.trackHeight]),[w,P,S]=le(void 0),R=e.useCallback(m=>{pe(()=>{const l=j.current[m],b=x.current;if(l==null||b==null)return;const L=S()==null?0:k.current;P(l.offsetLeft+l.offsetWidth/2),T.current&&(T.current(),T.current=void 0);const E=l.offsetLeft-(b.offsetWidth-l.offsetWidth)/2;T.current=ve(b,E,L)})},[S,P,k]);return e.useImperativeHandle(f,()=>({reset:()=>R(y.current)}),[y,R]),e.useEffect(()=>{R(o)},[o,R]),ue(()=>{R(y.current)},[A,y,R]),s.jsxs("div",{className:H(u("header"),a?de:void 0),children:[s.jsxs("div",{className:u("nav"),children:[n.navLeft&&s.jsx("div",{className:u("nav-left"),children:n.navLeft}),s.jsxs("div",{className:u("tab-list",{scrollable:d}),role:"tablist",ref:x,children:[p.map((m,l)=>s.jsx("div",{role:"tab","aria-selected":l===o,className:u("tab",{disabled:m.disabled,active:l===o&&!m.disabled}),onClick:b=>{h.onTabClick&&h.onTabClick(b,{disabled:m.disabled,index:l,key:m.key}),!m.disabled&&o!==l&&g(m.key,{index:l})},ref:b=>{j.current[l]=b},children:s.jsx("div",{className:u("tab-title",{ellipsis:!d&&i}),children:m.title})},m.key)),p.length>0&&w!=null&&s.jsx("div",{className:u("track"),style:{background:t,height:$,width:W,left:w,transitionDuration:"".concat(c,"ms")}})]}),n.navRight&&s.jsx("div",{className:u("nav-right"),children:n.navRight})]}),n.navBottom]})});F.displayName="TabsHeader";const ke=F,ye=U({border:!1,animated:!1,ellipsis:!0,sticky:!1,stickyProps:{},tabSwipeThreshold:4,swipeable:!1,slots:{}}),J=e.forwardRef((o,d)=>{const i=e.useRef(null),c=e.useRef(null),t=e.useRef(null),[{border:n,animated:a,ellipsis:p,sticky:g,stickyProps:h,tabSwipeThreshold:f,swipeable:k,slots:y},{defaultActiveKey:x,activeKey:j,onChange:T,onTabClick:A,trackWidth:W,trackHeight:$,trackColor:w,transitionDuration:P,children:S,className:R,...m}]=ye(o);e.useImperativeHandle(d,()=>({element:i.current,reset:()=>{var r,N;(r=t.current)==null||r.reset(),(N=c.current)==null||N.reset()}}),[t]);const l=e.useContext(te.Context),b=ne(l.transitionDuration,P),{value:L,onChangeRef:E}=se({value:j!=null?String(j):void 0,defaultValue:()=>x!=null?String(x):void 0,onChange:T!=null?r=>{r!=null&&T(r)}:void 0}),[K,C]=he(S),v=V(r=>{const N=K.findIndex(Z=>Z===L);return oe(N<0?r||0:N,0,Math.max(K.length-1,0))},[K,L]),[D,I]=e.useState(v),X=e.useMemo(()=>C.length>f||!p,[C.length,f,p]);e.useEffect(()=>{c.current&&D!==v&&(c.current.swipeTo(v,{animation:!0}),I(v))},[v,D]);const B=()=>s.jsx(ke,{transitionDuration:b,activeIndex:v,scrollable:X,ellipsis:p,slots:y,metaList:C,trackWidth:W,trackHeight:$,trackColor:w,border:n,onChange:r=>{E.current(r)},onTabClick:A,ref:t}),Y=()=>a||k?s.jsx(q,{defaultActiveIndex:v,className:u("swipe"),loop:!1,autoplay:0,duration:b,touchable:k,indicator:!1,onActiveIndexChange:r=>{E.current(C[r].key),I(r)},ref:c,children:C.map(r=>r.panel)}):C.map(r=>r.panel);return s.jsxs("div",{className:H(u(),R),...m,ref:i,children:[g?s.jsx(ae,{...h,container:()=>i.current,children:B()}):B(),s.jsx("div",{className:u("content",{animated:a}),children:s.jsx(_.Provider,{value:{activeKey:C[v]&&C[v].key,animated:a,swipeable:k},children:Y()})})]})});J.displayName="Tabs";const xe=J,Re=U({title:null,disabled:!1,forceRender:!1}),Q=e.forwardRef((o,d)=>{const[{forceRender:i},{className:c,children:t,...n}]=Re(o),a=n["data-fnx-tab-panel-key"],{activeKey:p,animated:g,swipeable:h}=e.useContext(_),f=a===p,[k,y]=e.useState(()=>f||i);e.useEffect(()=>{f&&y(!0)},[f]);const x=()=>s.jsx(G.Provider,{value:{active:f},children:k&&t});return g||h?s.jsx(q.Item,{role:"tabpanel",className:H(u("swipe-item",{inactive:!f}),c),"aria-hidden":!f,...n,children:s.jsx("div",{className:u("panel",c),ref:d,children:x()})}):s.jsx("div",{role:"tabpanel",className:H(u("panel"),c),...n,ref:d,style:{display:f?void 0:"none",...n.style},children:x()})});Q.displayName="TabsPanel";const Ce=Q,M=xe;M.Context=_;M.Panel=Ce;M.PanelContext=G;const De=M;export{De as T};
