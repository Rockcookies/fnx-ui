import{r as L,b as D,c as Z,a as q,j as a,F as G}from"./index-acc727ed.js";import{D as I}from"./index-aac52a1a.js";import{u as ee}from"./use-demo-translate-af347a14.js";import{F as j}from"./index-cd3ec507.js";import{u as ae}from"./use-unmounted-ref-dd1b8a47.js";import{I as x}from"./index-95f1e0da.js";import{P as k}from"./index-071cdb70.js";import{n as F,s as te}from"./misc-276e45ca.js";import{c as le}from"./config-component-props-c0788442.js";import{u as ne}from"./use-merged-prop-ref-b9b1260a.js";import{u as re}from"./use-update-effect-9fcceba0.js";import{L as oe}from"./index-4c2dac52.js";import{u as se}from"./index-de276461.js";import{T as H}from"./index-7284439f.js";import{c as ie}from"./format-73c0cb3b.js";import{c as ce}from"./config-data-names-cf5b0d3b.js";import"./index-f55e3552.js";import"./use-theme-f282d90a.js";import"./index-9ea1a4ee.js";import"./constants-905d732f.js";import"./use-merged-prop-78f8d6c6.js";import"./use-controlled-state-2016da2e.js";import"./use-focus-cc6e6d02.js";import"./scroll-a0e7f6b9.js";import"./detect-9e279ab2.js";import"./use-creation-aa086326.js";import"./use-on-popup-open-e0fdd969.js";import"./event-471798e4.js";import"./touch-helper-e91fac31.js";import"./index-58401949.js";import"./CSSTransition-08aaae48.js";import"./index-e24dce68.js";import"./style-696f78db.js";import"./index-7fbd3c59.js";import"./raf-e95fb200.js";import"./react-354fcae6.js";import"./use-safe-state-54822164.js";import"./use-get-state-708b6cfd.js";const de=ce({label:"label",value:"value",loading:"loading",disabled:"disabled",children:"children"}),me=de,ue="fnx-cascader",c=q(ue);function J(e,s,p){if(!Array.isArray(p)||p.length<=0)return[];const d=[{options:p}];for(let f=0;f<s.length;f++){const g=d[f],S=s[f],t=g.options.findIndex(m=>e.value(m)===S&&!e.disabled(m)),r=g.options[t];if(!r)return d;if(g.active=r,e.loading(r))return d.push({options:[]}),d;const n=e.children(r);if(!Array.isArray(n))return d;d.push({options:n})}return d}function P(e){const s=[];for(const p of e){if(!p.active)return s;s.push(p.active)}return s}const pe=le({defaultValue:[],dataNames:{},onConfirm:F,onCancel:F,onChange:F,swipeable:!1,closeIcon:a(x,{name:"cross"}),slots:{}}),$=L.forwardRef((e,s)=>{const[{defaultValue:p,dataNames:d,onConfirm:f,onCancel:g,onChange:S,swipeable:t,closeIcon:r,slots:n},{data:m,title:v,placeholder:z,onLoadData:B,activeColor:w,className:E,...V}]=pe(e),K=se("cascader"),i=me(d),[C,M]=L.useState(()=>J(i,p,m)),R=ne(C),[X,O]=L.useState(()=>Math.max(P(C).length-1,0)),Y=(o,l)=>{if(i.disabled(l))return;const u=C.slice(0,o+1).map((y,T)=>o===T?{...y,active:l}:y),N=i.children(l),h=Array.isArray(N)?N:void 0,b=P(u),A=b.map(y=>i.value(y));if(S(A,b),h&&h.length>0){M(u.concat({options:h})),O(o+1);return}if(h&&h.length<=0||!B){M(u),f(A,b);return}!i.loading(l)&&B&&B(P(u)),M(u.concat([{options:[]}])),O(o+1)};re(()=>{const o=J(i,P(R.current).map(l=>i.value(l)),m);M(o),O(l=>ie(l,0,Math.max(o.length-1,0)))},[i,m,R]);const _=()=>D("div",{className:c("header"),children:[a("div",{className:c("title"),children:v}),r!==!1&&a("span",{className:c("close-icon"),onClick:()=>{g()},children:r||a(x,{name:"cross"})})]}),Q=(o,l,u,N)=>{const h=!!i.loading(l),b=l===N,A=i.disabled(l),y=i.label(l);let T;return h?T=a(x.Spinner,{className:c("loading-icon")}):b&&(T=a(x,{name:"success",className:c("selected-icon")})),D("li",{role:"menuitemradio",tabIndex:A?void 0:b?0:-1,"aria-checked":b?"true":void 0,"aria-disabled":A?"true":void 0,className:c("option",{selected:b,disabled:A,loading:h}),style:{color:b?w:void 0},onClick:()=>Y(o,l),children:[n.option?n.option(l,{selected:b}):a("span",{className:c("label"),children:y}),T]},u)},W=()=>{if(C.length)return a(H,{animated:!0,swipeable:t,tabSwipeThreshold:0,className:c("tabs"),activeKey:X,trackColor:w,onChange:o=>O(parseInt(o,10)),children:C.map((o,l)=>{const u=C[l-1];return D(H.Panel,{title:a("span",{className:c("tab-title",{unselected:!o.active}),children:o.active?i.label(o.active):z||K.select}),children:[n.optionsTop&&n.optionsTop(l),D("div",{className:c("options-container"),children:[a("ul",{role:"menu",className:c("options"),children:o.options.map((N,h)=>Q(l,N,h,o.active))}),u&&u.active&&i.loading(u.active)&&a(oe,{className:c("loading"),color:w,size:30})]}),n.optionsBottom&&n.optionsBottom(l)]},l)})})};return D("div",{className:Z(c(),E),...V,ref:s,children:[_(),W()]})});$.displayName="Cascader";const he=$,U=he,be={"zh-CN":{basicUsage:"基础用法",area:"地区",selectArea:"请选择地区",customColor:"自定义颜色",asyncOptions:"异步加载选项",customContent:"自定义选项上方内容",currentLevel:e=>`当前为第 ${e} 级`,areaData:[{label:"湖北省",children:[{label:"武汉市",children:[{label:"江岸区"},{label:"硚口区"}]},{label:"宜昌市",disabled:!0,children:[{label:"西陵区"},{label:"夷陵区"}]}]},{label:"江西省",children:[{label:"南昌市",children:[{label:"东湖区"},{label:"西湖区"}]},{label:"景德镇市",children:[{label:"昌江区"},{label:"珠山区"}]}]}]},"en-US":{basicUsage:"Basic usage",area:"Area",selectArea:"Select Area",customColor:"Custom Color",asyncOptions:"Async Options",customContent:"Custom Content",currentLevel:e=>`Current level is ${e}`,areaData:[{label:"Hubei",children:[{label:"Wuhan",children:[{label:"JiangAn"},{label:"QiaoKou"}]},{label:"Yichang",disabled:!0,children:[{label:"XiLing"},{label:"YiLing"}]}]},{label:"Jiangxi",children:[{label:"Nanchang",children:[{label:"DongHu"},{label:"XiHu"}]},{label:"Jingdezhen",children:[{label:"ChangJiang"},{label:"ZhuShan"}]}]}]}};function ea(){const[e]=ee(be,"en-US"),s=t=>a(j,{label:e.area,clickable:!0,rightIcon:a(x,{name:"arrow-right"}),children:a(j.Input,{readOnly:!0,placeholder:e.selectArea,value:t&&t.length>0?t.join(" / "):void 0})}),[p,d]=L.useState(()=>e.areaData.map(t=>({label:t.label}))),f=(t,r)=>{for(const n of t){if(n.label===r)return n;if(n.children){const m=f(n.children,r);if(m)return m}}},g=ae(),S=L.useCallback((t,r=1e3)=>{te(r).then(()=>{g.current||t()})},[g]);return D(G,{children:[a(I,{title:e.basicUsage,cardMode:!0,children:a(k.Select,{round:!0,select:a(U,{data:e.areaData,title:e.selectArea,dataNames:{value:"label"}}),children:t=>s(t)})}),a(I,{title:e.customColor,cardMode:!0,children:a(k.Select,{round:!0,select:a(U,{data:e.areaData,title:e.selectArea,dataNames:{value:"label"},activeColor:"var(--fnx-success-color)"}),children:t=>s(t)})}),a(I,{title:e.asyncOptions,cardMode:!0,children:a(k.Select,{round:!0,select:a(U,{data:p,title:e.selectArea,dataNames:{value:"label"},onLoadData:t=>{const r=t[t.length-1];r.loading=!0,d(n=>[...n]),S(()=>{var m;const n=f(e.areaData,r.label);n&&(r.loading=!1,r.children=(m=n.children)==null?void 0:m.map(v=>({label:v.label,children:v.children==null?[]:void 0})),d(v=>[...v]))},1e3)}}),children:t=>s(t)})}),a(I,{title:e.customContent,cardMode:!0,children:a(k.Select,{round:!0,select:a(U,{data:e.areaData,title:e.selectArea,dataNames:{value:"label"},slots:{optionsTop:t=>a("div",{style:{padding:"10px 16px 0",color:"var(--fnx-gray-500)"},children:e.currentLevel(t+1)})}}),children:t=>s(t)})})]})}export{ea as default};
