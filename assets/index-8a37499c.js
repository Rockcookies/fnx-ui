import{r as t,j as _,c as O,a as Q}from"./index-8b435b75.js";import{c as U}from"./config-component-props-c0788442.js";import{u as X}from"./use-merged-prop-ref-bd8415d7.js";import{b as Y,l as Z}from"./event-471798e4.js";import{a as tt,g as ot}from"./scroll-a0e7f6b9.js";import{i as et,g as S}from"./style-696f78db.js";import{u as f}from"./format-3509efe4.js";import{n as k}from"./misc-276e45ca.js";const nt="fnx-sticky",M=Q(nt),st=U({zIndex:99,offsetTop:0,offsetBottom:0,position:"top",onChange:k,onScroll:k}),N=t.forwardRef((j,H)=>{const[{zIndex:g,offsetTop:y,offsetBottom:v,position:b,onChange:I,onScroll:$},{container:z,children:F,className:A,style:R,...D}]=st(j),[i,L]=t.useState(),[T,V]=t.useState(),[a,W]=t.useState(),[m,q]=t.useState(),E=t.useMemo(()=>f(y),[y]),w=t.useMemo(()=>f(v),[v]),u=t.useRef(null),c=X({position:b,onChange:I,onScroll:$,fixed:i,offsetTop:E,offsetBottom:w,container:z}),B=t.useMemo(()=>({element:u.current,isFixed:()=>!!c.current.fixed}),[c]);t.useImperativeHandle(H,()=>B,[B]);const C=t.useCallback(()=>{const o=u.current;if(!o||et(o))return;const e=S(o);let n=!1;const{container:l,position:p,offsetTop:d,offsetBottom:h}=c.current;let r;if(typeof l=="function"){const s=l();s!=null&&(r=S(s))}else l!=null&&(r=S(l));let x=0;if(p==="top")if(r){const s=r.bottom-d-e.height;n=d>e.top&&r.bottom>0,x=s<0?s:0}else n=d>e.top;else if(p==="bottom"){const{clientHeight:s}=document.documentElement;if(r){const P=s-r.top-h-e.height;n=s-h<e.bottom&&s>r.top,x=P<0?-P:0}else n=s-h<e.bottom}L(n),q(e.width),W(e.height),V(x);const K=tt(window);c.current.onScroll({scrollTop:K,fixed:n})},[c]);t.useEffect(()=>{const o=u.current;if(o==null)return;const e=ot(o),n=()=>C();Y(e,"scroll",n,{passive:!0});const l=Array.from([()=>e.removeEventListener("scroll",n),Z(n)]);return()=>{for(const p of l)p()}},[C]),t.useEffect(()=>{i!=null&&c.current.onChange({fixed:i})},[i,c]);const G=()=>i?{...{width:m!=null?f(m):void 0,height:a!=null?f(a):void 0},...R}:R,J=()=>{if(!i)return;const o={width:m!=null?f(m):void 0,height:a!=null?f(a):void 0,transform:T!=null?"translate3d(0, ".concat(T,"px, 0)"):void 0,zIndex:g!=null?g:void 0};return b==="top"?o.top="".concat(E,"px"):o.bottom="".concat(w,"px"),o};return _.jsx("div",{className:O(M({fixed:i}),A),style:G(),...D,ref:u,children:_.jsx("div",{className:M("container"),style:J(),children:F})})});N.displayName="Sticky";const pt=N;export{pt as S};
