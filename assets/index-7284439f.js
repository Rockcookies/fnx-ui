import{r as e,a as te,b as M,c as A,j as u}from"./index-acc727ed.js";import{C as ne}from"./index-f55e3552.js";import{c as V}from"./config-component-props-c0788442.js";import{u as ae}from"./use-controlled-state-2016da2e.js";import{u as q}from"./use-creation-aa086326.js";import{u as se}from"./use-merged-prop-78f8d6c6.js";import{S as re}from"./index-e24dce68.js";import{u as oe,S as G}from"./index-7fbd3c59.js";import{a as z,c as ie}from"./format-73c0cb3b.js";import{i as ce}from"./misc-276e45ca.js";import{t as le}from"./react-354fcae6.js";import{u as U}from"./use-merged-prop-ref-b9b1260a.js";import{u as ue}from"./use-get-state-708b6cfd.js";import{u as de}from"./use-update-effect-9fcceba0.js";import{c as fe}from"./constants-905d732f.js";import{r as me,c as pe,d as he}from"./raf-e95fb200.js";const I=e.createContext({}),F=e.createContext({});function be(r){const d=[],o=[];return le(r).forEach((t,n)=>{if(!e.isValidElement(t))return;const a=t.key!=null?`${t.key}`:`${n}`;o.push(a),d.push({key:a,title:t.props.title,disabled:!!t.props.disabled,panel:e.cloneElement(t,{key:a,...t.props,"data-fnx-tab-panel-key":a})})}),[q(t=>t&&ce(t,o)?t:o,[o]),d]}const ve="fnx-tabs",l=te(ve),ke=(r,d,o)=>{let i=0;const t=r.scrollLeft,n=o===0?1:Math.round(o/16);let a;function p(){r.scrollLeft+=(d-t)/n,++i<n?a=me(p):a=void 0}return p(),()=>{a!=null&&pe(a)}},J=e.forwardRef(({activeIndex:r,scrollable:d,ellipsis:o,transitionDuration:i,trackColor:t,slots:n,border:a,metaList:p,onChange:N,...h},f)=>{const k=U(i),y=U(r),C=e.useRef(null),w=e.useRef({}),g=e.useRef(),$=oe(),K=e.useMemo(()=>z(h.trackWidth),[h.trackWidth]),_=e.useMemo(()=>z(h.trackHeight),[h.trackHeight]),[x,S,L]=ue(void 0),R=e.useCallback(m=>{he(()=>{const c=w.current[m],b=C.current;if(c==null||b==null)return;const E=L()==null?0:k.current;S(c.offsetLeft+c.offsetWidth/2),g.current&&(g.current(),g.current=void 0);const H=c.offsetLeft-(b.offsetWidth-c.offsetWidth)/2;g.current=ke(b,H,E)})},[L,S,k]);return e.useImperativeHandle(f,()=>({reset:()=>R(y.current)}),[y,R]),e.useEffect(()=>{R(r)},[r,R]),de(()=>{R(y.current)},[$,y,R]),M("div",{className:A(l("header"),a?fe:void 0),children:[M("div",{className:l("nav"),children:[n.navLeft&&u("div",{className:l("nav-left"),children:n.navLeft}),M("div",{className:l("tab-list",{scrollable:d}),role:"tablist",ref:C,children:[p.map((m,c)=>u("div",{role:"tab","aria-selected":c===r,className:l("tab",{disabled:m.disabled,active:c===r&&!m.disabled}),onClick:b=>{h.onTabClick&&h.onTabClick(b,{disabled:m.disabled,index:c,key:m.key}),!m.disabled&&r!==c&&N(m.key,{index:c})},ref:b=>{w.current[c]=b},children:u("div",{className:l("tab-title",{ellipsis:!d&&o}),children:m.title})},m.key)),p.length>0&&x!=null&&u("div",{className:l("track"),style:{background:t,height:_,width:K,left:x,transitionDuration:`${i}ms`}})]}),n.navRight&&u("div",{className:l("nav-right"),children:n.navRight})]}),n.navBottom]})});J.displayName="TabsHeader";const ye=J,Ce=V({border:!1,animated:!1,ellipsis:!0,sticky:!1,stickyProps:{},tabSwipeThreshold:4,swipeable:!1,slots:{}}),Q=e.forwardRef((r,d)=>{const o=e.useRef(null),i=e.useRef(null),t=e.useRef(null),[{border:n,animated:a,ellipsis:p,sticky:N,stickyProps:h,tabSwipeThreshold:f,swipeable:k,slots:y},{defaultActiveKey:C,activeKey:w,onChange:g,onTabClick:$,trackWidth:K,trackHeight:_,trackColor:x,transitionDuration:S,children:L,className:R,...m}]=Ce(r);e.useImperativeHandle(d,()=>({element:o.current,reset:()=>{var s,P;(s=t.current)==null||s.reset(),(P=i.current)==null||P.reset()}}),[t]);const c=e.useContext(ne.Context),b=se(c.transitionDuration,S),{value:E,onChangeRef:H}=ae({value:w!=null?String(w):void 0,defaultValue:()=>C!=null?String(C):void 0,onChange:g!=null?s=>{s!=null&&g(s)}:void 0}),[D,T]=be(L),v=q(s=>{const P=D.findIndex(ee=>ee===E);return ie(P<0?s||0:P,0,Math.max(D.length-1,0))},[D,E]),[B,O]=e.useState(v),Y=e.useMemo(()=>T.length>f||!p,[T.length,f,p]);e.useEffect(()=>{i.current&&B!==v&&(i.current.swipeTo(v,{animation:!0}),O(v))},[v,B]);const j=()=>u(ye,{transitionDuration:b,activeIndex:v,scrollable:Y,ellipsis:p,slots:y,metaList:T,trackWidth:K,trackHeight:_,trackColor:x,border:n,onChange:s=>{H.current(s)},onTabClick:$,ref:t}),Z=()=>a||k?u(G,{defaultActiveIndex:v,className:l("swipe"),loop:!1,autoplay:0,duration:b,touchable:k,indicator:!1,onActiveIndexChange:s=>{H.current(T[s].key),O(s)},ref:i,children:T.map(s=>s.panel)}):T.map(s=>s.panel);return M("div",{className:A(l(),R),...m,ref:o,children:[N?u(re,{...h,container:()=>o.current,children:j()}):j(),u("div",{className:l("content",{animated:a}),children:u(I.Provider,{value:{activeKey:T[v]&&T[v].key,animated:a,swipeable:k},children:Z()})})]})});Q.displayName="Tabs";const Re=Q,Te=V({title:null,disabled:!1,forceRender:!1}),X=e.forwardRef((r,d)=>{const[{forceRender:o},{className:i,children:t,...n}]=Te(r),a=n["data-fnx-tab-panel-key"],{activeKey:p,animated:N,swipeable:h}=e.useContext(I),f=a===p,[k,y]=e.useState(()=>f||o);e.useEffect(()=>{f&&y(!0)},[f]);const C=()=>u(F.Provider,{value:{active:f},children:k&&t});return N||h?u(G.Item,{role:"tabpanel",className:A(l("swipe-item",{inactive:!f}),i),"aria-hidden":!f,...n,children:u("div",{className:l("panel",i),ref:d,children:C()})}):u("div",{role:"tabpanel",className:A(l("panel"),i),...n,ref:d,style:{display:f?void 0:"none",...n.style},children:C()})});X.displayName="TabsPanel";const ge=X,W=Re;W.Context=I;W.Panel=ge;W.PanelContext=F;const Be=W;export{Be as T};
