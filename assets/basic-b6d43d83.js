import{r as D,j as e,c as W,a as Z}from"./index-8b435b75.js";import{D as M}from"./index-588a6987.js";import{u as q}from"./use-demo-translate-489d42ac.js";import{F as w}from"./index-f0275fca.js";import{u as G}from"./use-unmounted-ref-2a5aff7e.js";import{I as S}from"./index-f0ac2a00.js";import{P as O}from"./index-8d4b6373.js";import{n as B,s as ee}from"./misc-276e45ca.js";import{c as ae}from"./config-component-props-c0788442.js";import{u as te}from"./use-merged-prop-ref-bd8415d7.js";import{u as se}from"./use-update-effect-311108d7.js";import{L as le}from"./index-f59b2ddc.js";import{u as ne}from"./index-ebeef9c4.js";import{T as E}from"./index-5a32ce02.js";import{c as re}from"./format-3509efe4.js";import{c as oe}from"./config-data-names-c324360a.js";import"./index-fdd3a7d6.js";import"./use-theme-8dbf9539.js";import"./index-fdc7973b.js";import"./constants-a731eda5.js";import"./use-merged-prop-78f8d6c6.js";import"./use-controlled-state-e2423fe7.js";import"./use-focus-8f2ca401.js";import"./scroll-a0e7f6b9.js";import"./detect-9e279ab2.js";import"./use-creation-3d9fab3f.js";import"./use-on-popup-open-26f1d831.js";import"./event-471798e4.js";import"./touch-helper-e91fac31.js";import"./index-e8afc6c8.js";import"./react-a0edb2dd.js";import"./index-8a37499c.js";import"./style-696f78db.js";import"./index-6ad4a01f.js";import"./raf-e95fb200.js";import"./use-safe-state-d07d3d84.js";import"./use-get-state-34a6027d.js";const ie=oe({label:"label",value:"value",loading:"loading",disabled:"disabled",children:"children"}),ce=ie,de="fnx-cascader",c=Z(de);function F(a,o,p){if(!Array.isArray(p)||p.length<=0)return[];const d=[{options:p}];for(let f=0;f<o.length;f++){const g=d[f],A=o[f],t=g.options.findIndex(m=>a.value(m)===A&&!a.disabled(m)),n=g.options[t];if(!n)return d;if(g.active=n,a.loading(n))return d.push({options:[]}),d;const l=a.children(n);if(!Array.isArray(l))return d;d.push({options:l})}return d}function I(a){const o=[];for(const p of a){if(!p.active)return o;o.push(p.active)}return o}const me=ae({defaultValue:[],dataNames:{},onConfirm:B,onCancel:B,onChange:B,swipeable:!1,closeIcon:e.jsx(S,{name:"cross"}),slots:{}}),H=D.forwardRef((a,o)=>{const[{defaultValue:p,dataNames:d,onConfirm:f,onCancel:g,onChange:A,swipeable:t,closeIcon:n,slots:l},{data:m,title:v,placeholder:J,onLoadData:P,activeColor:U,className:$,...z}]=me(a),V=ne("cascader"),i=ce(d),[x,T]=D.useState(()=>F(i,p,m)),R=te(x),[K,L]=D.useState(()=>Math.max(I(x).length-1,0)),X=(r,s)=>{if(i.disabled(s))return;const u=x.slice(0,r+1).map((N,y)=>r===y?{...N,active:s}:N),j=i.children(s),h=Array.isArray(j)?j:void 0,b=I(u),C=b.map(N=>i.value(N));if(A(C,b),h&&h.length>0){T(u.concat({options:h})),L(r+1);return}if(h&&h.length<=0||!P){T(u),f(C,b);return}!i.loading(s)&&P&&P(I(u)),T(u.concat([{options:[]}])),L(r+1)};se(()=>{const r=F(i,I(R.current).map(s=>i.value(s)),m);T(r),L(s=>re(s,0,Math.max(r.length-1,0)))},[i,m,R]);const Y=()=>e.jsxs("div",{className:c("header"),children:[e.jsx("div",{className:c("title"),children:v}),n!==!1&&e.jsx("span",{className:c("close-icon"),onClick:()=>{g()},children:n||e.jsx(S,{name:"cross"})})]}),_=(r,s,u,j)=>{const h=!!i.loading(s),b=s===j,C=i.disabled(s),N=i.label(s);let y;return h?y=e.jsx(S.Spinner,{className:c("loading-icon")}):b&&(y=e.jsx(S,{name:"success",className:c("selected-icon")})),e.jsxs("li",{role:"menuitemradio",tabIndex:C?void 0:b?0:-1,"aria-checked":b?"true":void 0,"aria-disabled":C?"true":void 0,className:c("option",{selected:b,disabled:C,loading:h}),style:{color:b?U:void 0},onClick:()=>X(r,s),children:[l.option?l.option(s,{selected:b}):e.jsx("span",{className:c("label"),children:N}),y]},u)},Q=()=>{if(x.length)return e.jsx(E,{animated:!0,swipeable:t,tabSwipeThreshold:0,className:c("tabs"),activeKey:K,trackColor:U,onChange:r=>L(parseInt(r,10)),children:x.map((r,s)=>{const u=x[s-1];return e.jsxs(E.Panel,{title:e.jsx("span",{className:c("tab-title",{unselected:!r.active}),children:r.active?i.label(r.active):J||V.select}),children:[l.optionsTop&&l.optionsTop(s),e.jsxs("div",{className:c("options-container"),children:[e.jsx("ul",{role:"menu",className:c("options"),children:r.options.map((j,h)=>_(s,j,h,r.active))}),u&&u.active&&i.loading(u.active)&&e.jsx(le,{className:c("loading"),color:U,size:30})]}),l.optionsBottom&&l.optionsBottom(s)]},s)})})};return e.jsxs("div",{className:W(c(),$),...z,ref:o,children:[Y(),Q()]})});H.displayName="Cascader";const ue=H,k=ue,pe={"zh-CN":{basicUsage:"基础用法",area:"地区",selectArea:"请选择地区",customColor:"自定义颜色",asyncOptions:"异步加载选项",customContent:"自定义选项上方内容",currentLevel:a=>"当前为第 ".concat(a," 级"),areaData:[{label:"湖北省",children:[{label:"武汉市",children:[{label:"江岸区"},{label:"硚口区"}]},{label:"宜昌市",disabled:!0,children:[{label:"西陵区"},{label:"夷陵区"}]}]},{label:"江西省",children:[{label:"南昌市",children:[{label:"东湖区"},{label:"西湖区"}]},{label:"景德镇市",children:[{label:"昌江区"},{label:"珠山区"}]}]}]},"en-US":{basicUsage:"Basic usage",area:"Area",selectArea:"Select Area",customColor:"Custom Color",asyncOptions:"Async Options",customContent:"Custom Content",currentLevel:a=>"Current level is ".concat(a),areaData:[{label:"Hubei",children:[{label:"Wuhan",children:[{label:"JiangAn"},{label:"QiaoKou"}]},{label:"Yichang",disabled:!0,children:[{label:"XiLing"},{label:"YiLing"}]}]},{label:"Jiangxi",children:[{label:"Nanchang",children:[{label:"DongHu"},{label:"XiHu"}]},{label:"Jingdezhen",children:[{label:"ChangJiang"},{label:"ZhuShan"}]}]}]}};function Ze(){const[a]=q(pe,"en-US"),o=t=>e.jsx(w,{label:a.area,clickable:!0,rightIcon:e.jsx(S,{name:"arrow-right"}),children:e.jsx(w.Input,{readOnly:!0,placeholder:a.selectArea,value:t&&t.length>0?t.join(" / "):void 0})}),[p,d]=D.useState(()=>a.areaData.map(t=>({label:t.label}))),f=(t,n)=>{for(const l of t){if(l.label===n)return l;if(l.children){const m=f(l.children,n);if(m)return m}}},g=G(),A=D.useCallback((t,n=1e3)=>{ee(n).then(()=>{g.current||t()})},[g]);return e.jsxs(e.Fragment,{children:[e.jsx(M,{title:a.basicUsage,cardMode:!0,children:e.jsx(O.Select,{round:!0,select:e.jsx(k,{data:a.areaData,title:a.selectArea,dataNames:{value:"label"}}),children:t=>o(t)})}),e.jsx(M,{title:a.customColor,cardMode:!0,children:e.jsx(O.Select,{round:!0,select:e.jsx(k,{data:a.areaData,title:a.selectArea,dataNames:{value:"label"},activeColor:"var(--fnx-success-color)"}),children:t=>o(t)})}),e.jsx(M,{title:a.asyncOptions,cardMode:!0,children:e.jsx(O.Select,{round:!0,select:e.jsx(k,{data:p,title:a.selectArea,dataNames:{value:"label"},onLoadData:t=>{const n=t[t.length-1];n.loading=!0,d(l=>[...l]),A(()=>{var m;const l=f(a.areaData,n.label);l&&(n.loading=!1,n.children=(m=l.children)==null?void 0:m.map(v=>({label:v.label,children:v.children==null?[]:void 0})),d(v=>[...v]))},1e3)}}),children:t=>o(t)})}),e.jsx(M,{title:a.customContent,cardMode:!0,children:e.jsx(O.Select,{round:!0,select:e.jsx(k,{data:a.areaData,title:a.selectArea,dataNames:{value:"label"},slots:{optionsTop:t=>e.jsx("div",{style:{padding:"10px 16px 0",color:"var(--fnx-gray-500)"},children:a.currentLevel(t+1)})}}),children:t=>o(t)})})]})}export{Ze as default};
