import{r as a,b as B,c as D,a as K,j as c}from"./index-d6e0bb7d.js";import{b as R}from"./index-442896ee.js";import{u as U}from"./use-merged-prop-ref-6fa0e9a5.js";import{I as h}from"./index-9b422fb8.js";import{P as $}from"./popup-helper-942ee2c7.js";import{c as Y}from"./config-component-props-c0788442.js";import{P as W}from"./index-8da67885.js";import{c as q}from"./detect-9e279ab2.js";import{n as z}from"./misc-276e45ca.js";const y="fnx-toast",g=K(y),F=Y({visible:!1,duration:2e3,forbidClick:!1,overlay:!1,overlayCloseable:!1,onClick:z}),x=`${y}--unclickable`;let u=0;const L=a.forwardRef((e,s)=>{const[{visible:t,duration:o,forbidClick:i,overlay:f,overlayCloseable:m,onClick:p},{mountTo:v,position:d,message:C,icon:S,clickCloseable:A,children:E,className:_,...I}]=F(e),[T,b]=a.useState(!1);a.useEffect(()=>{if(b(t),t&&o>0){const r=setTimeout(()=>{b(!1)},o);return()=>{clearTimeout(r)}}},[t,o]),a.useEffect(()=>{if(T&&i&&q())return u||document.body.classList.add(x),u++,()=>{u--,u||document.body.classList.remove(x)}},[T,i]);const H=()=>{const r=S;return r&&c("div",{className:g("icon"),children:r})},j=()=>{const r=C||E;return r&&c("div",{className:g("message"),children:r})};return B(W,{visible:T,mountTo:v,className:D(g([d,{text:!S}]),_),renderOnShow:!0,destroyOnHide:!0,lockScroll:!1,overlay:f,overlayCloseable:m,...I,ref:s,onClick:r=>{A&&b(!1),p(r)},children:[H(),j()]})});L.displayName="Toast";const P=L,k=new $;let w=!1;function G(e,s={}){return k.create(({onUpdate:t,remove:o})=>{const i=()=>{const[{onAfterHide:f,...m},p]=a.useState(e);return a.useEffect(()=>t(d=>{p(C=>({...C,...d}))}),[]),c(P,{visible:!0,...m,mountTo:!1,onAfterHide:()=>{o(),f&&f()}})};return i.displayName="ToastStatic",i},s.container)}const n=P,l=(e,s={},t)=>{const o=typeof e=="string"?{message:e}:e;return w||n.clearAll(),G({...s,...o},t)},N=(e,s)=>l(e,{icon:c(h.Spinner,{}),forbidClick:!0},s),M=(e,s)=>l(e,{icon:c(h,{name:"success"})},s),O=(e,s)=>l(e,{icon:c(h,{name:"fail"})},s);n.show=e=>l(e);n.loading=e=>N(e);n.success=e=>M(e);n.fail=e=>O(e);n.useToast=()=>{const e=a.useContext(R),s=U(e);return a.useMemo(()=>{const t=()=>({container:s.current.mountTo()});return{show:o=>l(o,{},t()),loading:o=>N(o,t()),success:o=>M(o,t()),fail:o=>O(o,t())}},[s])};n.clearAll=()=>{k.clear()};n.allowMultiple=e=>{w=!!e};const re=n;export{re as T};
