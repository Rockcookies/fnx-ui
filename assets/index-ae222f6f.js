import{r as t,b as O,c as H,j as p,a as G}from"./index-e0a0e62b.js";import{C as te}from"./index-f26d845a.js";import{c as L}from"./config-component-props-c0788442.js";import{u as q}from"./use-merged-prop-78f8d6c6.js";import{a as ne,f as oe,u as U,c as le}from"./format-73c0cb3b.js";import{u as J}from"./use-controlled-state-c80e6a10.js";import{u as K}from"./use-focus-a8b0c791.js";import{I as se}from"./index-328d196d.js";import{u as re}from"./use-creation-bef55742.js";import{i as ae}from"./misc-276e45ca.js";const ie=t.createContext({}),ue=t.createContext({}),ce="fnx-field",x=G(ce),de=L({labelProps:{},controlProps:{},titleProps:{},contentProps:{},disabled:!1,help:[]}),Q=t.forwardRef((s,d)=>{const[{labelProps:r,controlProps:a,titleProps:c,contentProps:u,disabled:n,help:o},{labelAlign:P,helpAlign:v,colon:b,required:R,labelWidth:E,label:I,controlPrefix:_,controlSuffix:g,className:F,children:h,...T}]=de(s),i=t.useContext(ie),{meta:l,isRequired:S}=t.useContext(ue),w=q("left",P,i.labelAlign),A=q("left",v,i.helpAlign),$=q(!1,b,i.colon),N=q(i.requiredMark===!0,R),y=q(void 0,E,i.labelWidth);let f=l&&l.errors||[];Array.isArray(o)?f=[...o,...f]:f=[o,...f];const C={};l&&l.validating?C.validating=!0:f.length>0?C.error=!0:l&&l.touched&&(C.success=!0);const M=()=>!t.isValidElement(h)||h.props.disabled!=null?h:t.cloneElement(h,{...h.props,disabled:n});return O(te,{...T,className:H(x([{...C,required:S!=null?S:N,disabled:n}]),F),ref:d,title:I,titleProps:{...r,className:H(x("label",[`text-${w}`,{colon:$}]),r.className,c.className),style:{...y!==0?{width:ne(y)}:{},...c.style}},contentProps:{...a,...u,className:H(x("control"),a.className,u.className)},children:[O("div",{className:x("control-body"),children:[_&&p("div",{className:x("control-prefix"),children:_}),p("div",{className:x("control-item"),children:M()}),g&&p("div",{className:x("control-suffix"),children:g})]}),f.length>0&&p("div",{className:x("help",[`text-${A}`]),children:f.map((V,B)=>p("div",{children:V},B))})]})});Q.displayName="Field";const fe=Q,me=(s,d)=>{const[r,a]=t.useState(null),c=t.useRef(!1),u=(n,o=!1)=>{if(c.current&&!o){a(n);return}r!==null&&a(null),d(n)};return{value:r||s,onComposition:n=>{if(n.type==="compositionend"&&c.current){const o=n.target.value;u(o,!0),c.current=!1}else c.current=!0},onChange:n=>u(n)}},Y=me;function j(s,d){const r=[...s];return d!=null&&r.length>=d?r.slice(0,d).join(""):s}const pe=s=>s==="number"?{type:"text",inputMode:"decimal"}:s==="digit"?{type:"tel",inputMode:"numeric"}:{type:s,inputMode:void 0},he="fnx-field-input",k=G(he),ge=L({defaultValue:"",type:"text",inputAlign:"left",clearable:!1,clearIcon:p(se,{name:"close"}),clearTrigger:"focus",readOnly:!1,disabled:!1}),Z=t.forwardRef((s,d)=>{const r=t.useRef(null),a=t.useRef(null),[{defaultValue:c,type:u,inputAlign:n,clearable:o,clearIcon:P,clearTrigger:v,readOnly:b,disabled:R},{value:E,onChange:I,onFocus:_,onBlur:g,maxLength:F,className:h,style:T,...i}]=ge(s);t.useImperativeHandle(d,()=>({element:r.current,input:a.current}));const{value:l,onChangeRef:S,controlled:w}=J({value:E,defaultValue:c,onChange:I});let A=l;F!=null&&!w&&(A=j(l,F));const $=e=>{if(e=j(e,F),u==="number"||u==="digit"){const m=u==="number";e=oe(e,{allowDot:m,allowMinus:m})}e!==l&&S.current(e)},{value:N,onComposition:y,onChange:f}=Y(A,$),{focus:C,onFocus:M,onBlur:V}=K(l,{readonly:b,node:a,onFocus:_,onBlur:g}),B=t.useMemo(()=>pe(u),[u]),W=()=>{if(o&&!b&&l!==""&&(v==="always"||v==="focus"&&C))return p("i",{className:k("clear"),onTouchStart:()=>$(""),children:P})};return O("span",{ref:r,className:H(k([{focused:C,disabled:R,...n!=="left"?{[`text-${n}`]:!0}:{}}]),h),style:T,children:[p("input",{...i,className:k("control"),ref:a,value:N,...B,disabled:R,readOnly:b,onBlur:V,onFocus:M,onCompositionStart:y,onCompositionEnd:y,onChange:e=>f(e.target.value)}),W()]})});Z.displayName="FieldInput";const Ce=Z,be="fnx-field-textarea",z=G(be),Ne=L({defaultValue:"",showCount:!1,autoSize:!1,rows:1,readOnly:!1,disabled:!1}),ee=t.forwardRef((s,d)=>{const r=t.useRef(null),a=t.useRef(null),c=t.useRef(null),[{defaultValue:u,showCount:n,autoSize:o,rows:P,readOnly:v,disabled:b},{value:R,onChange:E,onFocus:I,onBlur:_,maxLength:g,className:F,style:h,...T}]=Ne(s);t.useImperativeHandle(d,()=>({element:r.current,input:a.current}));const i=re(e=>{if(o===!1)return;const m=o===!0?[0,Number.MAX_SAFE_INTEGER]:[o.minHeight?U(o.minHeight):0,o.maxHeight?U(o.maxHeight):Number.MAX_SAFE_INTEGER];return e&&ae(e,m)?e:m},[o]),{value:l,onChangeRef:S,controlled:w}=J({value:R,defaultValue:u,onChange:E});let A=l;g!=null&&!w&&(A=j(l,g));const $=e=>{e=j(e,g),e!==l&&S.current(e)},{value:N,onComposition:y,onChange:f}=Y(A,$),{focus:C,onFocus:M,onBlur:V}=K(l,{readonly:v,node:a,onFocus:I,onBlur:_}),B=()=>{if(n===!1)return;const e=n===!0?({count:m,maxLength:D})=>`${m}${D!=null?` / ${D}`:""}`:n;return p("span",{className:z("count"),children:e({count:[...N].length,maxLength:g})})};t.useEffect(()=>{if(!i)return;const e=a.current,m=c.current;!e||!m||(e.style.height=`${le(m.scrollHeight,i[0],i[1])}px`)},[i,N]);const W=()=>{const e={};return i?e.minHeight=`${i[0]}px`:e.height="auto",e};return O("span",{ref:r,className:H(z([{focused:C,disabled:b}]),F),style:h,children:[p("textarea",{...T,className:z("control"),style:W(),rows:P,ref:a,value:N,disabled:b,readOnly:v,onBlur:V,onFocus:M,onCompositionStart:y,onCompositionEnd:y,onChange:e=>f(e.target.value)}),p("textarea",{"aria-hidden":"true",tabIndex:-1,ref:c,className:z("auto-size"),value:N,rows:P,readOnly:!0}),B()]})});ee.displayName="FieldTextArea";const ye=ee,X=fe;X.Input=Ce;X.TextArea=ye;const Ie=X;export{Ie as F,ie as a,ue as b};
