import{r as t,j as l,c as q,a as k}from"./index-8b435b75.js";import{C as ee}from"./index-fdc7973b.js";import{c as G}from"./config-component-props-c0788442.js";import{u as B}from"./use-merged-prop-78f8d6c6.js";import{a as te,f as ne,u as D,c as oe}from"./format-3509efe4.js";import{u as U}from"./use-controlled-state-e2423fe7.js";import{u as J}from"./use-focus-8f2ca401.js";import{I as se}from"./index-f0ac2a00.js";import{u as le}from"./use-creation-3d9fab3f.js";import{i as re}from"./misc-276e45ca.js";const ae=t.createContext({}),ie=t.createContext({}),ue="fnx-field",y=k(ue),ce=G({labelProps:{},controlProps:{},titleProps:{},contentProps:{},disabled:!1,help:[]}),K=t.forwardRef((r,f)=>{const[{labelProps:a,controlProps:i,titleProps:d,contentProps:c,disabled:n,help:o},{labelAlign:P,helpAlign:v,colon:x,required:R,labelWidth:j,label:E,controlPrefix:_,controlSuffix:g,className:F,children:h,...I}]=ce(r),u=t.useContext(ae),{meta:s,isRequired:S}=t.useContext(ie),T=B("left",P,u.labelAlign),A=B("left",v,u.helpAlign),$=B(!1,x,u.colon),b=B(u.requiredMark===!0,R),N=B(void 0,j,u.labelWidth);let m=s&&s.errors||[];Array.isArray(o)?m=[...o,...m]:m=[o,...m];const C={};s&&s.validating?C.validating=!0:m.length>0?C.error=!0:s&&s.touched&&(C.success=!0);const w=()=>!t.isValidElement(h)||h.props.disabled!=null?h:t.cloneElement(h,{...h.props,disabled:n});return l.jsxs(ee,{...I,className:q(y([{...C,required:S!=null?S:b,disabled:n}]),F),ref:f,title:E,titleProps:{...a,className:q(y("label",["text-".concat(T),{colon:$}]),a.className,d.className),style:{...N!==0?{width:te(N)}:{},...d.style}},contentProps:{...i,...c,className:q(y("control"),i.className,c.className)},children:[l.jsxs("div",{className:y("control-body"),children:[_&&l.jsx("div",{className:y("control-prefix"),children:_}),l.jsx("div",{className:y("control-item"),children:w()}),g&&l.jsx("div",{className:y("control-suffix"),children:g})]}),m.length>0&&l.jsx("div",{className:y("help",["text-".concat(A)]),children:m.map((M,V)=>l.jsx("div",{children:M},V))})]})});K.displayName="Field";const de=K,fe=(r,f)=>{const[a,i]=t.useState(null),d=t.useRef(!1),c=(n,o=!1)=>{if(d.current&&!o){i(n);return}a!==null&&i(null),f(n)};return{value:a||r,onComposition:n=>{if(n.type==="compositionend"&&d.current){const o=n.target.value;c(o,!0),d.current=!1}else d.current=!0},onChange:n=>c(n)}},Q=fe;function z(r,f){const a=[...r];return f!=null&&a.length>=f?a.slice(0,f).join(""):r}const me=r=>r==="number"?{type:"text",inputMode:"decimal"}:r==="digit"?{type:"tel",inputMode:"numeric"}:{type:r,inputMode:void 0},pe="fnx-field-input",W=k(pe),he=G({defaultValue:"",type:"text",inputAlign:"left",clearable:!1,clearIcon:l.jsx(se,{name:"close"}),clearTrigger:"focus",readOnly:!1,disabled:!1}),Y=t.forwardRef((r,f)=>{const a=t.useRef(null),i=t.useRef(null),[{defaultValue:d,type:c,inputAlign:n,clearable:o,clearIcon:P,clearTrigger:v,readOnly:x,disabled:R},{value:j,onChange:E,onFocus:_,onBlur:g,maxLength:F,className:h,style:I,...u}]=he(r);t.useImperativeHandle(f,()=>({element:a.current,input:i.current}));const{value:s,onChangeRef:S,controlled:T}=U({value:j,defaultValue:d,onChange:E});let A=s;F!=null&&!T&&(A=z(s,F));const $=e=>{if(e=z(e,F),c==="number"||c==="digit"){const p=c==="number";e=ne(e,{allowDot:p,allowMinus:p})}e!==s&&S.current(e)},{value:b,onComposition:N,onChange:m}=Q(A,$),{focus:C,onFocus:w,onBlur:M}=J(s,{readonly:x,node:i,onFocus:_,onBlur:g}),V=t.useMemo(()=>me(c),[c]),O=()=>{if(o&&!x&&s!==""&&(v==="always"||v==="focus"&&C))return l.jsx("i",{className:W("clear"),onTouchStart:()=>$(""),children:P})};return l.jsxs("span",{ref:a,className:q(W([{focused:C,disabled:R,...n!=="left"?{["text-".concat(n)]:!0}:{}}]),h),style:I,children:[l.jsx("input",{...u,className:W("control"),ref:i,value:b,...V,disabled:R,readOnly:x,onBlur:M,onFocus:w,onCompositionStart:N,onCompositionEnd:N,onChange:e=>m(e.target.value)}),O()]})});Y.displayName="FieldInput";const ge=Y,Ce="fnx-field-textarea",H=k(Ce),xe=G({defaultValue:"",showCount:!1,autoSize:!1,rows:1,readOnly:!1,disabled:!1}),Z=t.forwardRef((r,f)=>{const a=t.useRef(null),i=t.useRef(null),d=t.useRef(null),[{defaultValue:c,showCount:n,autoSize:o,rows:P,readOnly:v,disabled:x},{value:R,onChange:j,onFocus:E,onBlur:_,maxLength:g,className:F,style:h,...I}]=xe(r);t.useImperativeHandle(f,()=>({element:a.current,input:i.current}));const u=le(e=>{if(o===!1)return;const p=o===!0?[0,Number.MAX_SAFE_INTEGER]:[o.minHeight?D(o.minHeight):0,o.maxHeight?D(o.maxHeight):Number.MAX_SAFE_INTEGER];return e&&re(e,p)?e:p},[o]),{value:s,onChangeRef:S,controlled:T}=U({value:R,defaultValue:c,onChange:j});let A=s;g!=null&&!T&&(A=z(s,g));const $=e=>{e=z(e,g),e!==s&&S.current(e)},{value:b,onComposition:N,onChange:m}=Q(A,$),{focus:C,onFocus:w,onBlur:M}=J(s,{readonly:v,node:i,onFocus:E,onBlur:_}),V=()=>{if(n===!1)return;const e=n===!0?({count:p,maxLength:X})=>"".concat(p).concat(X!=null?" / ".concat(X):""):n;return l.jsx("span",{className:H("count"),children:e({count:[...b].length,maxLength:g})})};t.useEffect(()=>{if(!u)return;const e=i.current,p=d.current;!e||!p||(e.style.height="".concat(oe(p.scrollHeight,u[0],u[1]),"px"))},[u,b]);const O=()=>{const e={};return u?e.minHeight="".concat(u[0],"px"):e.height="auto",e};return l.jsxs("span",{ref:a,className:q(H([{focused:C,disabled:x}]),F),style:h,children:[l.jsx("textarea",{...I,className:H("control"),style:O(),rows:P,ref:i,value:b,disabled:x,readOnly:v,onBlur:M,onFocus:w,onCompositionStart:N,onCompositionEnd:N,onChange:e=>m(e.target.value)}),l.jsx("textarea",{"aria-hidden":"true",tabIndex:-1,ref:d,className:H("auto-size"),value:b,rows:P,readOnly:!0}),V()]})});Z.displayName="FieldTextArea";const be=Z,L=de;L.Input=ge;L.TextArea=be;const je=L;export{je as F,ae as a,ie as b};
