import{r as t,j as S,c as de,a as fe}from"./index-8b435b75.js";import{c as me}from"./config-component-props-c0788442.js";import{u as pe}from"./use-controlled-state-e2423fe7.js";import{u as he}from"./use-merged-prop-ref-bd8415d7.js";import{u as be}from"./use-focus-8f2ca401.js";import{p as ge}from"./event-471798e4.js";import{f as H,a as E}from"./format-3509efe4.js";import{n as Se}from"./misc-276e45ca.js";function Me(a,l){return Math.round((a+l)*1e10)/1e10}const M=a=>{if(a==null)return;let l;if(typeof a!="number"?l=Number(H(String(a).trim(),{allowDot:!0,allowMinus:!0})):l=a,!(l==null||isNaN(l)))return l},Ne=200,ve=600,we="fnx-stepper",N=fe(we),xe=me({defaultValue:"",mode:"string",allowEmpty:!1,step:1,showInput:!0,showPlus:!0,showMinus:!0,disabled:!1,disablePlus:!1,disableMinus:!1,disableInput:!1,longPress:!0,onStep:Se}),U=t.forwardRef((a,l)=>{const i=t.useRef(),[{defaultValue:W,mode:$,allowEmpty:q,step:_,showInput:J,showPlus:K,showMinus:Q,disabled:f,disablePlus:D,disableMinus:I,disableInput:v,longPress:X,onStep:Y},{onChange:Z,value:ee,min:V,max:j,buttonSize:m,inputWidth:F,precision:r,className:te,style:ne,...se}]=xe(a),o=t.useMemo(()=>M(V),[V]),c=t.useMemo(()=>M(j),[j]),w=t.useMemo(()=>M(_),[_]),k=t.useRef(null),x=t.useRef(null);t.useImperativeHandle(l,()=>({element:k.current,input:x.current}));const L=t.useMemo(()=>{const e=E(m);return{width:e,height:e}},[m]),ue=t.useMemo(()=>({width:E(F),height:E(m)}),[m,F]),B=e=>{if((e==null||e=="")&&q)return null;const n=H(e==null?"":String(e),{allowMinus:!0,allowDot:r==null||r>0});let s=n===""?0:Number(n);c!=null&&s>=c?s=c:o!=null&&s<=o?s=o:isNaN(s)&&(s=o!=null?o:0);const g=r!=null&&r>0?s.toFixed(r):String(s);return $==="string"?String(g):Number(g)},{value:p,onChangeRef:le,controlled:re}=pe({value:ee,defaultValue:W,onChange:Z});let d=p!=null?p:"";if(!re){const e=B(p);d=e!=null?e:""}const u=t.useMemo(()=>M(d),[d]),[O,z]=t.useState(()=>d),{focus:oe,onFocus:ae,onBlur:ie}=be(d,{node:x,readonly:v,onFocus:e=>{z(e)},onBlur:()=>{R(O)}}),y=t.useMemo(()=>I||f?!0:o==null||u==null?!1:u<=o,[I,f,u,o]),C=t.useMemo(()=>D||f?!0:c==null||u==null?!1:u>=c,[D,f,u,c]),R=e=>{const n=B(e);return n!==p&&le.current(n),n},P=he((e,n)=>{if(n&&n.preventDefault(),e==="minus"&&y||e==="plus"&&C)return;if(w==null)return R(u);const s=e==="minus"?-w:+w,g=Me(u!=null?u:0,s),G=R(g);G!=null&&Y(G,{offset:s,type:e})}),ce=e=>{v&&e.preventDefault()},h=t.useCallback(()=>{i.current&&(clearTimeout(i.current),i.current=void 0)},[]);t.useEffect(()=>h,[h]);const T=t.useRef(!1),A=e=>{if(!X)return;h(),T.current=!1;const n=()=>{i.current=setTimeout(()=>{P.current(e),n()},Ne)};i.current=setTimeout(()=>{T.current=!0,n()},ve)},b=e=>{i.current!=null&&(h(),T.current&&ge(e))};return S.jsxs("span",{className:de(N(),te),style:ne,role:"group",...se,ref:k,children:[S.jsx("button",{type:"button",style:L,className:N("minus",{hidden:!Q,disabled:y}),"aria-disabled":y||void 0,onClick:e=>P.current("minus",e),onTouchStart:()=>A("minus"),onTouchCancel:e=>b(e),onTouchEnd:e=>b(e)}),S.jsx("input",{className:N("input",{hidden:!J}),ref:x,type:r!=null&&r<=0?"tel":"text",role:"spinbutton",value:oe?O:d,style:ue,disabled:f,readOnly:v,inputMode:r!=null&&r<=0?"numeric":"decimal","aria-valuemax":c,"aria-valuemin":o,"aria-valuenow":u,onFocus:ae,onBlur:ie,onChange:e=>z(e.target.value),onMouseDown:ce}),S.jsx("button",{type:"button",style:L,className:N("plus",{hidden:!K,disabled:C}),"aria-disabled":C||void 0,onClick:e=>P.current("plus",e),onTouchStart:()=>A("plus"),onTouchCancel:e=>b(e),onTouchEnd:e=>b(e)})]})});U.displayName="Stepper";const ye=U,Ve=ye;export{Ve as S};
